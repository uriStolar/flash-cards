!function(){function e(e,t,n,a){a.setDefaults({className:"ngdialog-theme-default",showClose:!0,closeByDocument:!0,closeByEscape:!0,width:"75%",height:"40%"}),n.includeSpinner=!0,n.parentSelector="#loadingContainer",n.spinnerTemplate='<div class="center"><img src="/images/loading.svg"></div>',e.when("/",{templateUrl:"cards.html",controller:"CardController"}).when("/login",{controller:"LoginController",templateUrl:"login.html",controllerAs:"vm"}).when("/test",{controller:"FlashCardTestController",templateUrl:"flash-card-test.html"}).when("/index",{templateUrl:"cards.html",controller:"CardController"}).otherwise({redirectTo:"/login"})}function t(e,t){e.globals.currentUser&&(t.defaults.headers.common["x-access-token"]=e.globals.currentUser.authdata)}function n(e,n,a){t(e,a);var o=-1===$.inArray(n.path(),["/login","/register"]),r=e.globals.currentUser;o&&!r&&n.path("/login")}function a(e,a,o,r){e.globals=r.get("flash_card_creds")||{},t(e,o),n(e,a,o),e.$on("$locationChangeStart",function(t,r,i){n(e,a,o)})}angular.module("flashCard",["ngRoute","flashCard.controllers.main","flashCard.controllers.login","flashCard.controllers.cards","flashCard.controllers.cardModal","flashCard.controllers.cardsTest","flashCard.services","angular-loading-bar","ngAnimate","flash","LocalStorageModule","ngDialog","bw.paging","ui.tinymce"]).config(e).run(a),e.$inject=["$routeProvider","$locationProvider","cfpLoadingBarProvider","ngDialogProvider"],a.$inject=["$rootScope","$location","$http","localStorageService"]}(),function(){function e(e,t,n,a,o,r){function i(){a.getCards(e.currentPage,e.pageSize).then(function(t){e.cards=t.data.data.items;for(var n=0;n<e.cards.length;n++)e.cards[n].isFrontShown=!0;e.total=t.data.data.pagination.rowCount}).catch(function(e){o.create("danger",e.data.message,"custom-class")})}e.currentPage=1,e.pageSize=4,e.total=0,e.dialogShown=!1,e.dialogTitle="",e.currentCard={},e.getCards=i,n.$emit("onTabChanged",0),e.reload=function(){i()},e.pageContent=function(t,n,a,o){e.currentPage=n,e.pageSize=a,i()},e.flip=function(e){e.isFrontShown=!e.isFrontShown},e.delete=function(e){a.deleteCard(e.id).then(function(e){i()}).catch(function(e){o.create("danger",e.data.message,"custom-class")})},e.currentDialog={},e.edit=function(t){e.currentCard=t,e.currentCard.type=e.currentCard.type+"",e.currentDialog=r.open({template:"/templates/card.html",controller:"CardModalController",scope:e})},e.add=function(){e.currentCard={type:"1"},e.currentDialog=r.open({template:"/templates/card.html",controller:"CardModalController",scope:e})},e.addOrUpdate=function(){e.currentCard.id?a.updateCard(e.currentCard).then(function(t){e.dialogShown=!1,i()}).catch(function(e){o.create("danger",e.data.message,"custom-class")}):a.insertCard(e.currentCard).then(function(e){i()}).catch(function(e){o.create("danger",e.data.message,"custom-class")})},e.tinymceOptions={plugins:"link image code codesample autoresize",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | codesample"},e.tinymceOptionsReadOnly={plugins:"codesample autoresize",toolbar:"codesample",menubar:!1,readonly:1},i()}angular.module("flashCard.controllers.cards",[]).controller("CardController",["$scope","$location","$rootScope","flashCardService","Flash","ngDialog",e])}(),function(){function e(e,t,n,a,o,r){e.cancel=function(){e.currentDialog.close()};var i=!1;e.currentCard.hints?(e.currentCard.hints=JSON.parse(e.currentCard.hints),0===e.currentCard.hints.length&&(i=!0)):i=!0,i&&(e.currentCard.hints=[{hint:""}]),e.addHint=function(){e.currentCard.hints.push({hint:""})},e.addOrUpdate=function(){e.currentCard.type=Number(e.currentCard.type);var t=[],n=e.currentCard.hints;if(n&&n.length>0)for(var r=0;r<n.length;r++)null!==n[r].hint&&""!==n[r].hint&&t.push(n[r]);e.currentCard.hints=t,e.currentCard.id?a.updateCard(e.currentCard).then(function(t){e.currentDialog.close(),e.getCards()}).catch(function(e){o.create("danger",e.data.message,"card-error")}):a.insertCard(e.currentCard).then(function(t){e.currentDialog.close(),e.getCards()}).catch(function(e){o.create("danger",e.data.message,"card-error")})},e.tinymceOptions={plugins:"link image code codesample autoresize",toolbar:"undo redo | bold italic | alignleft aligncenter alignright | codesample"}}angular.module("flashCard.controllers.cardModal",[]).controller("CardModalController",["$scope","$location","$rootScope","flashCardService","Flash","ngDialog",e])}(),function(){function e(e,t,n,a,o){function r(){e.currentHint=null,e.currentHintIndex=0,a.getRandom().then(function(t){e.card=t.data.data,e.card.isFrontShown=!0,e.card.hints&&(e.card.hints=JSON.parse(e.card.hints)),e.areHintsAvailable=e.card.hints&&e.card.hints.length>0}).catch(function(e){o.create("danger",e.data.message,"custom-class")})}n.$emit("onTabChanged",1),e.card={isFrontShown:!0},e.flip=function(e){e.isFrontShown=!e.isFrontShown},e.refresh=function(){r()},e.currentHintIndex=0,e.showHints=function(){var t=e.card.hints;t.length>e.currentHintIndex?(e.currentHint=t[e.currentHintIndex].hint,e.currentHintIndex++):e.currentHint="No more hints are available"},e.areHintsAvailable=!1,e.tinymceOptionsReadOnly={plugins:"codesample autoresize",toolbar:"codesample",menubar:!1,readonly:1},r()}angular.module("flashCard.controllers.cardsTest",[]).controller("FlashCardTestController",["$scope","$location","$rootScope","flashCardService","Flash",e])}(),function(){function e(e,t,n){function a(){o.dataLoading=!0,t.login(o.username,o.password).then(function(n){t.setCredentials(o.username,o.password),o.dataLoading=!1,e.path("/index")}).catch(function(e){n.create("danger",e.data.message,"custom-class"),o.dataLoading=!1})}var o=this;o.login=a}angular.module("flashCard.controllers.login",[]).controller("LoginController",["$location","flashCardService","Flash",e])}(),function(){var e=function(e,t,n,a,o){e.selectedTab=-1,e.isLoggedIn=!1,t.$on("onTabChanged",function(t,n){console.log(n),e.isLoggedIn=!0,e.selectedTab=n}),e.logout=function(){e.selectedTab=-1,e.isLoggedIn=!1,n.logout(function(){a.path("/login")})},e.reloadServer=function(){n.flushCache().then(function(e){o.create("info",e.data.data.message,"custom-class")}).catch(function(e){o.create("danger",e.message,"custom-class")})}};angular.module("flashCard.controllers.main",[]).controller("MainController",["$scope","$rootScope","flashCardService","$location","Flash",e])}(),function(){var e=function(e,t,n,a){var o=function(t,n,a){return e.post("/api/v1/authenticate",{username:t,password:n})},r=function(e){a.remove("flash_card_creds"),n.globals={},e()},i=function(e,t){n.globals={currentUser:{username:e,authdata:t}},a.set("flash_card_creds",{currentUser:{username:e,authdata:t}})},l=function(t,n){return e.get("/api/v1/cards",{params:{currentPage:t,pageSize:n}})},c=function(t){return e.put("/api/v1/cards/"+t.id,t)},s=function(t){return e.post("/api/v1/cards",t)};return{login:o,logout:r,setCredentials:i,getCards:l,deleteCard:function(t){return e.delete("/api/v1/cards/"+t)},updateCard:c,insertCard:s,getRandom:function(t,n){return e.get("/api/v1/cards/random")}}};angular.module("flashCard.services",[]).factory("flashCardService",["$http","$location","$rootScope","localStorageService",e])}(),function(){"use strict";var e=angular.module("flash",[]);e.run(["$rootScope",function(e){e.flash={},e.flash.text="",e.flash.type="",e.flash.timeout=5e3,e.hasFlash=!1}]),e.directive("dynamic",["$compile",function(e){return{restrict:"A",replace:!0,link:function(t,n,a){t.$watch(a.dynamic,function(a){n.html(a),e(n.contents())(t)})}}}]),e.directive("closeFlash",["$compile","Flash",function(e,t){return{link:function(e,n){n.on("click",function(){t.dismiss()})}}}]),e.directive("flashMessage",["$compile","$rootScope",function(e,t){return{restrict:"A",template:'<div role="alert" ng-show="hasFlash" class="alert {{flash.addClass}} alert-{{flash.type}} alert-dismissible ng-hide alertIn alertOut "> <span dynamic="flash.text"></span> <button type="button" class="close" close-flash><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button> </div>',link:function(e,n,a){t.flash.timeout=parseInt(a.flashMessage,10)}}}]),e.factory("Flash",["$rootScope","$timeout",function(e,t){var n,a={};return a.create=function(a,o,r){var i=this;t.cancel(n),e.flash.type=a,e.flash.text=o,e.flash.addClass=r,t(function(){e.hasFlash=!0},100),n=t(function(){i.dismiss()},e.flash.timeout)},a.pause=function(){t.cancel(n)},a.dismiss=function(){t.cancel(n),t(function(){e.hasFlash=!1})},a}])}(),function(e,t){"use strict";var n=t.isDefined,a=t.isUndefined,o=t.isNumber,r=t.isObject,i=t.isArray,l=t.extend,c=t.toJson;t.module("LocalStorageModule",[]).provider("localStorageService",function(){this.prefix="ls",this.storageType="localStorage",this.cookie={expiry:30,path:"/"},this.notify={setItem:!0,removeItem:!1},this.setPrefix=function(e){return this.prefix=e,this},this.setStorageType=function(e){return this.storageType=e,this},this.setStorageCookie=function(e,t){return this.cookie.expiry=e,this.cookie.path=t,this},this.setStorageCookieDomain=function(e){return this.cookie.domain=e,this},this.setNotify=function(e,t){return this.notify={setItem:e,removeItem:t},this},this.$get=["$rootScope","$window","$document","$parse",function(e,t,s,d){var u,g=this,f=g.prefix,m=g.cookie,h=g.notify,p=g.storageType;s?s[0]&&(s=s[0]):s=document,"."!==f.substr(-1)&&(f=f?f+".":"");var v=function(e){return f+e},y=function(){try{var n=p in t&&null!==t[p],a=v("__"+Math.round(1e7*Math.random()));return n&&(u=t[p],u.setItem(a,""),u.removeItem(a)),n}catch(t){return p="cookie",e.$broadcast("LocalStorageModule.notification.error",t.message),!1}}(),b=function(t,n){if(n=a(n)?null:c(n),!y||"cookie"===g.storageType)return y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:n,storageType:"cookie"}),T(t,n);try{u&&u.setItem(v(t),n),h.setItem&&e.$broadcast("LocalStorageModule.notification.setitem",{key:t,newvalue:n,storageType:g.storageType})}catch(a){return e.$broadcast("LocalStorageModule.notification.error",a.message),T(t,n)}return!0},C=function(t){if(!y||"cookie"===g.storageType)return y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),A(t);var n=u?u.getItem(v(t)):null;if(!n||"null"===n)return null;try{return JSON.parse(n)}catch(e){return n}},$=function(){var t,n;for(t=0;t<arguments.length;t++)if(n=arguments[t],y&&"cookie"!==g.storageType)try{u.removeItem(v(n)),h.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:g.storageType})}catch(t){e.$broadcast("LocalStorageModule.notification.error",t.message),k(n)}else y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),h.removeItem&&e.$broadcast("LocalStorageModule.notification.removeitem",{key:n,storageType:"cookie"}),k(n)},D=function(){if(!y)return e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),!1;var t=f.length,n=[];for(var a in u)if(a.substr(0,t)===f)try{n.push(a.substr(t))}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.Description),[]}return n},S=function(t){var n=f?new RegExp("^"+f):new RegExp,a=t?new RegExp(t):new RegExp;if(!y||"cookie"===g.storageType)return y||e.$broadcast("LocalStorageModule.notification.warning","LOCAL_STORAGE_NOT_SUPPORTED"),O();var o=f.length;for(var r in u)if(n.test(r)&&a.test(r.substr(o)))try{$(r.substr(o))}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),O()}return!0},w=function(){try{return t.navigator.cookieEnabled||"cookie"in s&&(s.cookie.length>0||(s.cookie="test").indexOf.call(s.cookie,"test")>-1)}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}}(),T=function(t,n,l){if(a(n))return!1;if((i(n)||r(n))&&(n=c(n)),!w)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;try{var d="",u=new Date,g="";if(null===n?(u.setTime(u.getTime()+-864e5),d="; expires="+u.toGMTString(),n=""):o(l)&&0!==l?(u.setTime(u.getTime()+24*l*60*60*1e3),d="; expires="+u.toGMTString()):0!==m.expiry&&(u.setTime(u.getTime()+24*m.expiry*60*60*1e3),d="; expires="+u.toGMTString()),t){var f="; path="+m.path;m.domain&&(g="; domain="+m.domain),s.cookie=v(t)+"="+encodeURIComponent(n)+d+f+g}}catch(t){return e.$broadcast("LocalStorageModule.notification.error",t.message),!1}return!0},A=function(t){if(!w)return e.$broadcast("LocalStorageModule.notification.error","COOKIES_NOT_SUPPORTED"),!1;for(var n=s.cookie&&s.cookie.split(";")||[],a=0;a<n.length;a++){for(var o=n[a];" "===o.charAt(0);)o=o.substring(1,o.length);if(0===o.indexOf(v(t)+"=")){var r=decodeURIComponent(o.substring(f.length+t.length+1,o.length));try{return JSON.parse(r)}catch(e){return r}}}return null},k=function(e){T(e,null)},O=function(){for(var e=null,t=f.length,n=s.cookie.split(";"),a=0;a<n.length;a++){for(e=n[a];" "===e.charAt(0);)e=e.substring(1,e.length);var o=e.substring(t,e.indexOf("="));k(o)}};return{isSupported:y,getStorageType:function(){return p},set:b,add:b,get:C,keys:D,remove:$,clearAll:S,bind:function(e,t,a,o){o=o||t;var i=C(o);return null===i&&n(a)?i=a:r(i)&&r(a)&&(i=l(a,i)),d(t).assign(e,i),e.$watch(t,function(e){b(o,e)},r(e[t]))},deriveKey:v,length:function(){for(var e=0,n=t[p],a=0;a<n.length;a++)0===n.key(a).indexOf(f)&&e++;return e},cookie:{isSupported:w,set:T,add:T,get:A,remove:k,clearAll:O}}}]})}(window,window.angular),angular.module("ui.tinymce",[]).value("uiTinymceConfig",{}).directive("uiTinymce",["$rootScope","$compile","$timeout","$window","$sce","uiTinymceConfig","uiTinymceService",function(e,t,n,a,o,r,i){return r=r||{},r.baseUrl&&(tinymce.baseURL=r.baseUrl),{require:["ngModel","^?form"],priority:599,link:function(l,c,s,d){function u(e){e?(g(),m&&m.getBody().setAttribute("contenteditable",!1)):(g(),m&&!m.settings.readonly&&m.getDoc()&&m.getBody().setAttribute("contenteditable",!0))}function g(){m||(m=tinymce.get(s.id))}if(a.tinymce){var f,m,h=d[0],p=d[1]||null,v={debounce:!0},y=function(t){var n=t.getContent({format:v.format}).trim();n=o.trustAsHtml(n),h.$setViewValue(n),e.$$phase||l.$digest()},b=i.getUniqueId();s.$set("id",b),f={},angular.extend(f,l.$eval(s.uiTinymce));var C=function(e){var t;return function(e){n.cancel(t),t=n(function(){return function(e){e.isDirty()&&(e.save(),y(e))}(e)},400)}}(),$={setup:function(t){t.on("init",function(){h.$render(),h.$setPristine(),h.$setUntouched(),p&&p.$setPristine()}),t.on("ExecCommand change NodeChange ObjectResized",function(){return v.debounce?void C(t):(t.save(),void y(t))}),t.on("blur",function(){c[0].blur(),h.$setTouched(),e.$$phase||l.$digest()}),t.on("remove",function(){c.remove()}),r.setup&&r.setup(t,{updateView:y}),f.setup&&f.setup(t,{updateView:y})},format:f.format||"html",selector:"#"+s.id};angular.extend(v,r,f,$),n(function(){v.baseURL&&(tinymce.baseURL=v.baseURL);var e=tinymce.init(v);e&&"function"==typeof e.then?e.then(function(){u(l.$eval(s.ngDisabled))}):u(l.$eval(s.ngDisabled))}),h.$formatters.unshift(function(e){return e?o.trustAsHtml(e):""}),h.$parsers.unshift(function(e){return e?o.getTrustedHtml(e):""}),h.$render=function(){g();var e=h.$viewValue?o.getTrustedHtml(h.$viewValue):"";m&&m.getDoc()&&(m.setContent(e),m.fire("change"))},s.$observe("disabled",u),l.$on("$tinymce:refresh",function(e,n){var a=s.id;if(angular.isUndefined(n)||n===a){var o=c.parent(),r=c.clone();r.removeAttr("id"),r.removeAttr("style"),r.removeAttr("aria-hidden"),tinymce.execCommand("mceRemoveEditor",!1,a),o.append(t(r)(l))}}),l.$on("$destroy",function(){g(),m&&(m.remove(),m=null)})}}}}]).service("uiTinymceService",[function(){return new function(){var e=0;return{getUniqueId:function(){return"ui-tinymce-"+ ++e}}}}]),function(e,t){"undefined"!=typeof module&&module.exports?(t("undefined"==typeof angular?require("angular"):angular),module.exports="ngDialog"):"function"==typeof define&&define.amd?define(["angular"],t):t(e.angular)}(this,function(e){"use strict";var t=e.module("ngDialog",[]),n=e.element,a=e.isDefined,o=(document.body||document.documentElement).style,r=a(o.animation)||a(o.WebkitAnimation)||a(o.MozAnimation)||a(o.MsAnimation)||a(o.OAnimation),i="animationend webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend",l={html:!1,body:!1},c={},s=[],d=!1,u=!1;return t.provider("ngDialog",function(){var t=this.defaults={className:"ngdialog-theme-default",appendClassName:"",disableAnimation:!1,plain:!1,showClose:!0,closeByDocument:!0,closeByEscape:!0,closeByNavigation:!1,appendTo:!1,preCloseCallback:!1,overlay:!0,cache:!0,trapFocus:!0,preserveFocus:!0,ariaAuto:!0,ariaRole:null,ariaLabelledById:null,ariaLabelledBySelector:null,ariaDescribedById:null,ariaDescribedBySelector:null,bodyClassName:"ngdialog-open",width:null,height:null};this.setForceHtmlReload=function(e){l.html=e||!1},this.setForceBodyReload=function(e){l.body=e||!1},this.setDefaults=function(n){e.extend(t,n)},this.setOpenOnePerName=function(e){u=e||!1};var a,o=0,g=0,f={};this.$get=["$document","$templateCache","$compile","$q","$http","$rootScope","$timeout","$window","$controller","$injector",function(m,h,p,v,y,b,C,$,D,S){var w=[],T={onDocumentKeydown:function(e){27===e.keyCode&&A.close("$escape")},activate:function(e){e.data("$ngDialogOptions").trapFocus&&(e.on("keydown",T.onTrapFocusKeydown),w.body.on("keydown",T.onTrapFocusKeydown))},deactivate:function(e){e.off("keydown",T.onTrapFocusKeydown),w.body.off("keydown",T.onTrapFocusKeydown)},deactivateAll:function(t){e.forEach(t,function(t){var n=e.element(t);T.deactivate(n)})},setBodyPadding:function(e){var t=parseInt(w.body.css("padding-right")||0,10);w.body.css("padding-right",t+e+"px"),w.body.data("ng-dialog-original-padding",t),b.$broadcast("ngDialog.setPadding",e)},resetBodyPadding:function(){var e=w.body.data("ng-dialog-original-padding");e?w.body.css("padding-right",e+"px"):w.body.css("padding-right",""),b.$broadcast("ngDialog.setPadding",0)},performCloseDialog:function(e,t){var n=e.data("$ngDialogOptions"),o=e.attr("id"),l=c[o];if(l){if(void 0!==$.Hammer){var u=l.hammerTime;u.off("tap",a),u.destroy&&u.destroy(),delete l.hammerTime}else e.unbind("click");1===g&&w.body.unbind("keydown",T.onDocumentKeydown),e.hasClass("ngdialog-closing")||(g-=1);var m=e.data("$ngDialogPreviousFocus");m&&m.focus&&m.focus(),b.$broadcast("ngDialog.closing",e,t),g=g<0?0:g,r&&!n.disableAnimation?(l.$destroy(),e.unbind(i).bind(i,function(){T.closeDialogElement(e,t)}).addClass("ngdialog-closing")):(l.$destroy(),T.closeDialogElement(e,t)),f[o]&&(f[o].resolve({id:o,value:t,$dialog:e,remainingDialogs:g}),delete f[o]),c[o]&&delete c[o],s.splice(s.indexOf(o),1),s.length||(w.body.unbind("keydown",T.onDocumentKeydown),d=!1)}},closeDialogElement:function(e,t){var n=e.data("$ngDialogOptions");e.remove(),0===g&&(w.html.removeClass(n.bodyClassName),w.body.removeClass(n.bodyClassName),T.resetBodyPadding()),b.$broadcast("ngDialog.closed",e,t)},closeDialog:function(t,n){var a=t.data("$ngDialogPreCloseCallback");if(a&&e.isFunction(a)){var o=a.call(t,n);if(e.isObject(o))o.closePromise?o.closePromise.then(function(){T.performCloseDialog(t,n)},function(){return!1}):o.then(function(){T.performCloseDialog(t,n)},function(){return!1});else{if(!1===o)return!1;T.performCloseDialog(t,n)}}else T.performCloseDialog(t,n)},onTrapFocusKeydown:function(t){var n,a=e.element(t.currentTarget);if(a.hasClass("ngdialog"))n=a;else if(null===(n=T.getActiveDialog()))return;var o=9===t.keyCode,r=!0===t.shiftKey;o&&T.handleTab(n,t,r)},handleTab:function(e,t,n){var a=T.getFocusableElements(e);if(0===a.length)return void(document.activeElement&&document.activeElement.blur&&document.activeElement.blur());var o=document.activeElement,r=Array.prototype.indexOf.call(a,o),i=-1===r,l=0===r,c=r===a.length-1,s=!1;n?(i||l)&&(a[a.length-1].focus(),s=!0):(i||c)&&(a[0].focus(),s=!0),s&&(t.preventDefault(),t.stopPropagation())},autoFocus:function(e){var t=e[0],a=t.querySelector("*[autofocus]");if(null===a||(a.focus(),document.activeElement!==a)){var o=T.getFocusableElements(e);if(o.length>0)return void o[0].focus();var r=T.filterVisibleElements(t.querySelectorAll("h1,h2,h3,h4,h5,h6,p,span"));if(r.length>0){var i=r[0];n(i).attr("tabindex","-1").css("outline","0"),i.focus()}}},getFocusableElements:function(e){var t=e[0],n=t.querySelectorAll("a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed, *[tabindex], *[contenteditable]"),a=T.filterTabbableElements(n);return T.filterVisibleElements(a)},filterTabbableElements:function(e){for(var t=[],a=0;a<e.length;a++){var o=e[a];"-1"!==n(o).attr("tabindex")&&t.push(o)}return t},filterVisibleElements:function(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];(a.offsetWidth>0||a.offsetHeight>0)&&t.push(a)}return t},getActiveDialog:function(){var e=document.querySelectorAll(".ngdialog");return 0===e.length?null:n(e[e.length-1])},applyAriaAttributes:function(e,t){if(t.ariaAuto){if(!t.ariaRole){var n=T.getFocusableElements(e).length>0?"dialog":"alertdialog";t.ariaRole=n}t.ariaLabelledBySelector||(t.ariaLabelledBySelector="h1,h2,h3,h4,h5,h6"),t.ariaDescribedBySelector||(t.ariaDescribedBySelector="article,section,p")}t.ariaRole&&e.attr("role",t.ariaRole),T.applyAriaAttribute(e,"aria-labelledby",t.ariaLabelledById,t.ariaLabelledBySelector),T.applyAriaAttribute(e,"aria-describedby",t.ariaDescribedById,t.ariaDescribedBySelector)},applyAriaAttribute:function(e,t,a,o){if(a&&e.attr(t,a),o){var r=e.attr("id"),i=e[0].querySelector(o);if(!i)return;var l=r+"-"+t;return n(i).attr("id",l),e.attr(t,l),l}},detectUIRouter:function(){try{return e.module("ui.router"),!0}catch(e){return!1}},getRouterLocationEventName:function(){return T.detectUIRouter()?"$stateChangeStart":"$locationChangeStart"}},A={__PRIVATE__:T,open:function(r){function i(e,t){return b.$broadcast("ngDialog.templateLoading",e),y.get(e,t||{}).then(function(t){return b.$broadcast("ngDialog.templateLoaded",e),t.data||""})}var l=null;if(r=r||{},!(u&&r.name&&(l=r.name.toLowerCase().replace(/\s/g,"-")+"-dialog",this.isOpen(l)))){var m=e.copy(t),k=++o;l=l||"ngdialog"+k,s.push(l),void 0!==m.data&&(void 0===r.data&&(r.data={}),r.data=e.merge(e.copy(m.data),r.data)),e.extend(m,r);var O;f[l]=O=v.defer();var E;c[l]=E=e.isObject(m.scope)?m.scope.$new():b.$new();var L,x,F,I=e.extend({},m.resolve);return e.forEach(I,function(t,n){I[n]=e.isString(t)?S.get(t):S.invoke(t,null,null,n)}),v.all({template:function(t){return t?e.isString(t)&&m.plain?t:"boolean"!=typeof m.cache||m.cache?i(t,{cache:h}):i(t,{cache:!1}):"Empty template"}(m.template||m.templateUrl),locals:v.all(I)}).then(function(t){var o=t.template,r=t.locals;m.showClose&&(o+='<div class="ngdialog-close"></div>');var i=m.overlay?"":" ngdialog-no-overlay";if(L=n('<div id="'+l+'" class="ngdialog'+i+'"></div>'),L.html(m.overlay?'<div class="ngdialog-overlay"></div><div class="ngdialog-content" role="document">'+o+"</div>":'<div class="ngdialog-content" role="document">'+o+"</div>"),L.data("$ngDialogOptions",m),E.ngDialogId=l,m.data&&e.isString(m.data)){var c=m.data.replace(/^\s*/,"")[0];E.ngDialogData="{"===c||"["===c?e.fromJson(m.data):new String(m.data),E.ngDialogData.ngDialogId=l}else m.data&&e.isObject(m.data)&&(E.ngDialogData=m.data,E.ngDialogData.ngDialogId=l);if(m.className&&L.addClass(m.className),m.appendClassName&&L.addClass(m.appendClassName),m.width&&(F=L[0].querySelector(".ngdialog-content"),e.isString(m.width)?F.style.width=m.width:F.style.width=m.width+"px"),m.height&&(F=L[0].querySelector(".ngdialog-content"),e.isString(m.height)?F.style.height=m.height:F.style.height=m.height+"px"),m.disableAnimation&&L.addClass("ngdialog-disabled-animation"),x=m.appendTo&&e.isString(m.appendTo)?e.element(document.querySelector(m.appendTo)):w.body,T.applyAriaAttributes(L,m),m.preCloseCallback){var s;e.isFunction(m.preCloseCallback)?s=m.preCloseCallback:e.isString(m.preCloseCallback)&&E&&(e.isFunction(E[m.preCloseCallback])?s=E[m.preCloseCallback]:E.$parent&&e.isFunction(E.$parent[m.preCloseCallback])?s=E.$parent[m.preCloseCallback]:b&&e.isFunction(b[m.preCloseCallback])&&(s=b[m.preCloseCallback])),s&&L.data("$ngDialogPreCloseCallback",s)}if(E.closeThisDialog=function(e){T.closeDialog(L,e)},m.controller&&(e.isString(m.controller)||e.isArray(m.controller)||e.isFunction(m.controller))){var u;m.controllerAs&&e.isString(m.controllerAs)&&(u=m.controllerAs);var f=D(m.controller,e.extend(r,{$scope:E,$element:L}),!0,u);m.bindToController&&e.extend(f.instance,{ngDialogId:E.ngDialogId,ngDialogData:E.ngDialogData,closeThisDialog:E.closeThisDialog,confirm:E.confirm}),"function"==typeof f?L.data("$ngDialogControllerController",f()):L.data("$ngDialogControllerController",f)}if(C(function(){var e=document.querySelectorAll(".ngdialog");T.deactivateAll(e),p(L)(E);var t=$.innerWidth-w.body.prop("clientWidth");w.html.addClass(m.bodyClassName),w.body.addClass(m.bodyClassName);var n=t-($.innerWidth-w.body.prop("clientWidth"));n>0&&T.setBodyPadding(n),x.append(L),T.activate(L),m.trapFocus&&T.autoFocus(L),m.name?b.$broadcast("ngDialog.opened",{dialog:L,name:m.name}):b.$broadcast("ngDialog.opened",L)}),d||(w.body.bind("keydown",T.onDocumentKeydown),d=!0),m.closeByNavigation){var h=T.getRouterLocationEventName();b.$on(h,function(e){!1===T.closeDialog(L)&&e.preventDefault()})}if(m.preserveFocus&&L.data("$ngDialogPreviousFocus",document.activeElement),a=function(e){var t=!!m.closeByDocument&&n(e.target).hasClass("ngdialog-overlay"),a=n(e.target).hasClass("ngdialog-close");(t||a)&&A.close(L.attr("id"),a?"$closeButton":"$document")},void 0!==$.Hammer){(E.hammerTime=$.Hammer(L[0])).on("tap",a)}else L.bind("click",a);return g+=1,A}),{id:l,closePromise:O.promise,close:function(e){T.closeDialog(L,e)}}}},openConfirm:function(a){var o=v.defer(),r=e.copy(t);a=a||{},void 0!==r.data&&(void 0===a.data&&(a.data={}),a.data=e.merge(e.copy(r.data),a.data)),e.extend(r,a),r.scope=e.isObject(r.scope)?r.scope.$new():b.$new(),r.scope.confirm=function(e){o.resolve(e);var t=n(document.getElementById(i.id));T.performCloseDialog(t,e)};var i=A.open(r);if(i)return i.closePromise.then(function(e){return e?o.reject(e.value):o.reject()}),o.promise},isOpen:function(e){return n(document.getElementById(e)).length>0},close:function(e,t){var a=n(document.getElementById(e));if(a.length)T.closeDialog(a,t);else if("$escape"===e){var o=s[s.length-1];a=n(document.getElementById(o)),a.data("$ngDialogOptions").closeByEscape&&T.closeDialog(a,"$escape")}else A.closeAll(t);return A},closeAll:function(e){for(var t=document.querySelectorAll(".ngdialog"),a=t.length-1;a>=0;a--){var o=t[a];T.closeDialog(n(o),e)}},getOpenDialogs:function(){return s},getDefaults:function(){return t}};return e.forEach(["html","body"],function(e){if(w[e]=m.find(e),l[e]){var t=T.getRouterLocationEventName();b.$on(t,function(){w[e]=m.find(e)})}}),A}]}),t.directive("ngDialog",["ngDialog",function(t){return{restrict:"A",scope:{ngDialogScope:"="},link:function(n,a,o){a.on("click",function(a){a.preventDefault();var r=e.isDefined(n.ngDialogScope)?n.ngDialogScope:"noScope";e.isDefined(o.ngDialogClosePrevious)&&t.close(o.ngDialogClosePrevious);var i=t.getDefaults();t.open({template:o.ngDialog,className:o.ngDialogClass||i.className,appendClassName:o.ngDialogAppendClass,controller:o.ngDialogController,controllerAs:o.ngDialogControllerAs,bindToController:o.ngDialogBindToController,scope:r,data:o.ngDialogData,showClose:"false"!==o.ngDialogShowClose&&("true"===o.ngDialogShowClose||i.showClose),closeByDocument:"false"!==o.ngDialogCloseByDocument&&("true"===o.ngDialogCloseByDocument||i.closeByDocument),closeByEscape:"false"!==o.ngDialogCloseByEscape&&("true"===o.ngDialogCloseByEscape||i.closeByEscape),overlay:"false"!==o.ngDialogOverlay&&("true"===o.ngDialogOverlay||i.overlay),preCloseCallback:o.ngDialogPreCloseCallback||i.preCloseCallback,bodyClassName:o.ngDialogBodyClass||i.bodyClassName})})}}}]),t});